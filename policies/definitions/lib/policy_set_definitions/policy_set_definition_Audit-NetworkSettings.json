{
  "name": "Audit-NetworkSettings",
  "properties": {
    "description": "Audit Azure Network Settings",
    "displayName": "Audit Azure Network Settings",
    "metadata": {
      "category": "Network"
    },
    "parameters": {
      "Effect": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "defaultValue": "Audit",
        "allowedValues": [
          "Audit",
          "Disabled"
        ]
      },
      "EffectIfNotExists": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the policy"
        },
        "defaultValue": "AuditIfNotExists",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ]
      }
    },
    "policyDefinitions": [
      {
        "policyDefinitionReferenceId": "API Management services should use a virtual network",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ef619a2c-cc4d-4d03-b2ba-8c94a834d85b",
        "parameters": {
          "effect": {
            "value": "[[parameters('Effect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "App Service apps should use a virtual network service endpoint",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2d21331d-a4c2-4def-a9ad-ee4e1e023beb",
        "parameters": {
          "effect": {
            "value": "[[parameters('EffectIfNotExists')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "Event Hub should use a virtual network service endpoint",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d63edb4a-c612-454d-b47d-191a724fcbf0",
        "parameters": {
          "effect": {
            "value": "[[parameters('EffectIfNotExists')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "Gateway subnets should not be configured with a network security group",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/35f9c03a-cc27-418e-9c0c-539ff999d010"
      },
      {
        "policyDefinitionReferenceId": "IP firewall rules on Azure Synapse workspaces should be removed",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/56fd377d-098c-4f02-8406-81eb055902b8",
        "parameters": {
          "effect": {
            "value": "[[parameters('Effect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "Key Vault should use a virtual network service endpoint",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ea4d6841-2173-4317-9747-ff522a45120f",
        "parameters": {
          "effect": {
            "value": "[[parameters('Effect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "MariaDB server should use a virtual network service endpoint",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/dfbd9a64-6114-48de-a47d-90574dc2e489",
        "parameters": {
          "effect": {
            "value": "[[parameters('EffectIfNotExists')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "MySQL server should use a virtual network service endpoint",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3375856c-3824-4e0e-ae6a-79e011dd4c47",
        "parameters": {
          "effect": {
            "value": "[[parameters('EffectIfNotExists')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "Network Watcher flow logs should have traffic analytics enabled",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2f080164-9f4d-497e-9db6-416dc9f7b48a",
        "parameters": {
          "effect": {
            "value": "[[parameters('Effect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "PostgreSQL server should use a virtual network service endpoint",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3c14b034-bcb6-4905-94e7-5b8e98a47b65",
        "parameters": {
          "effect": {
            "value": "[[parameters('EffectIfNotExists')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "SQL Server should use a virtual network service endpoint",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ae5d2f14-d830-42b6-9899-df6cfe9c71a3",
        "parameters": {
          "effect": {
            "value": "[[parameters('EffectIfNotExists')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "Storage Accounts should use a virtual network service endpoint",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/60d21c4f-21a3-4d94-85f4-b924e6aeeda4",
        "parameters": {
          "effect": {
            "value": "[[parameters('Effect')]"
          }
        }
      }
    ]
  },
  "type": "Microsoft.Authorization/policySetDefinitions"
}
