{
  "name": "DeployDefenderForCloud",
  "type": "Microsoft.Authorization/policyAssignments",
  "location": "${default_location}",
  "dependsOn": [],
  "identity": {
    "type": "SystemAssigned"
  },
  "properties": {
    "displayName": "Deploy Microsoft Defender for Cloud configuration Q1 2026",
    "description": "Deploy Microsoft Defender for Cloud configuration across the Aldi Nord Tenant",
    "scope": "/providers/Microsoft.Management/managementGroups/mg-aldi",
    "metadata": {
      "assignedBy": "Policy initiative assigned by Platform Team as part of Q1 2026 defender rollout"
    },
    "enforcementMode": "DoNotEnforce",
    "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/52290a28-dcec-4da1-9252-57f67fc9ba1b/providers/Microsoft.Authorization/policySetDefinitions/Deploy-DefenderForCloud",
    "parameters": {
      "emailSecurityContact": {
        "value": "cyberdefensecenter@aldi-nord.de"
      },
      "minimalSeverity": {
        "value": "High"
      },
      "attackPathSeverity": {
        "value": "Critical"
      },
      "logAnalytics": {
        "value": "/subscriptions/ac084e26-de58-47e4-92d4-0da6414956d8/resourcegroups/rg-logmanagementworkspace-prod/providers/microsoft.operationalinsights/workspaces/log-we-prod-logmanagementworkspace"
      },
      "enableAscForCosmosDbs": {
        "value": "DeployIfNotExists"
      },
      "enableAscForSql": {
        "value": "DeployIfNotExists"
      },
      "enableAscForSqlOnVm": {
        "value": "DeployIfNotExists"
      },
      "enableAscForArm": {
        "value": "DeployIfNotExists"
      },
      "ascForArmSubPlan": {
        "value": "PerApiCall"
      },
      "enableAscForOssDb": {
        "value": "DeployIfNotExists"
      },
      "enableAscForAppServices": {
        "value": "DeployIfNotExists"
      },
      "enableAscForKeyVault": {
        "value": "DeployIfNotExists"
      },
      "ascForKeyVaultSubPlan": {
        "value": "PerTransaction"
      },
      "enableAscForStorage": {
        "value": "DeployIfNotExists"
      },
      "ascForStorageIsOnUploadMalwareScanningEnabled": {
        "value": "false"
      },
      "ascForStorageCapGBPerMonthPerStorageAccount": {
        "value": 5000
      },
      "ascForStorageIsSensitiveDataDiscoveryEnabled": {
        "value": "true"
      },
      "enableAscForContainers": {
        "value": "DeployIfNotExists"
      },
      "enableAscForAI": {
        "value": "Disabled"
      },
      "ascForAIIsAIPromptEvidenceEnabled": {
        "value": "false"
      },
      "enableAscForServers": {
        "value": "DeployIfNotExists"
      },
      "ascForServersSubPlan": {
        "value": "P2"
      },
      "ascForServersIsAgentlessVmScanningEnabled": {
        "value": "true"
      },
      "ascForServersIsMdeDesignatedSubscriptionEnabled": {
        "value": "false"
      },
      "enableAscForServersVulnerabilityAssessments": {
        "value": "DeployIfNotExists"
      },
      "vulnerabilityAssessmentProvider": {
        "value": "mdeTvm"
      },
      "enableAscForCspm": {
        "value": "Disabled"
      },
      "ascForCspmIsSensitiveDataDiscoveryEnabled": {
        "value": "false"
      },
      "ascForCspmIsContainerRegistriesVulnerabilityAssessmentsEnabled": {
        "value": "false"
      },
      "ascForCspmIsAgentlessDiscoveryForKubernetesEnabled": {
        "value": "true"
      },
      "ascForCspmIsAgentlessVmScanningEnabled": {
        "value": "true"
      },
      "ascForCspmIsEntraPermissionsManagementEnabled": {
        "value": "true"
      },
      "enableTvmCheck": {
        "value": "DeployIfNotExists"
      }
    },
    "nonComplianceMessages": [
      {
        "message": "Microsoft Defender for Cloud baseline must be deployed and configured across Aldi Nord environment"
      }
    ],
    "notScopes": []
  }
}
