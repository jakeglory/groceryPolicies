{
  "type": "Microsoft.Authorization/policyAssignments",
  "apiVersion": "2022-06-01",
  "name": "Enforce-TLS-SSL-Q225",
  "location": "${default_location}",
  "dependsOn": [],
  "identity": {
    "type": "SystemAssigned"
  },
  "properties": {
    "description": "Choose either Deploy if not exist and append in combination with audit or Select Deny in the Policy effect. Deny polices shift left. Deploy if not exist and append enforce but can be changed, and because missing existence condition require then the combination of Audit.",
    "displayName": "Deny or Deploy and append TLS requirements and SSL enforcement on resources without Encryption in transit",
    "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/52290a28-dcec-4da1-9252-57f67fc9ba1b/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit_20241211",
    "enforcementMode": "Default",
    "nonComplianceMessages": [
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: App Service should have HTTPS enforced via configuration. Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "AppServiceHttpEffect" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: App Service app should be have at least TLS 1.2 configured. Please amend your resource configuration to meet Policy requirement. If there is valid reason why you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "AppServiceminTlsVersion" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: API App should be only accessible via HTTPS. Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "APIAppServiceHttpsEffect" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "WebAppServiceHttpsEffect" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "MySQLEnableSSLDeployEffect" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "MySQLEnableSSLEffect" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "PostgreSQLEnableSSLDeployEffect" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "PostgreSQLEnableSSLEffect" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "RedisTLSDeployEffect" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "RedisdisableNonSslPort" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "RedisDenyhttps" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "SQLManagedInstanceTLSDeployEffect" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "SQLManagedInstanceTLSEffect" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "SQLServerTLSDeployEffect" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "StorageDeployHttpsEnabledEffect" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "ContainerAppsHttpsOnlyEffect" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "Dine-FunctionApp-Tls" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "Deploy-LogicApp-TLS" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "Deny-LogicApp-Without-Https" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "Dine-Function-Apps-Slots-Tls" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "Dine-AppService-Apps-Tls" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "Deny-AppService-Apps-Https" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "Deny-AppService-Tls" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "DINE-AppService-AppSlotTls" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "Deny-FuncAppSlots-Https" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "Deny-FunctionApp-Https" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "Deny-AppService-Slots-Https" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "Deny-EH-minTLS" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "Deny-Sql-Db-Tls" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "Deny-Storage-Tls" },
      { "message": "Your deployment is not compliant with ALDI ISMS Policy: Requirements for IT-Operators: chapter 12.1 Reason: (add reason) Please amend your resource configuration to meet Policy requirement. If you cannot meet policy objective, please request for policy exemption via ServiceNow", "policyDefinitionReferenceId": "Deny-Synapse-Tls-Version" }
    ],
    "parameters": {
      "AKSIngressHttpsOnlyEffect": { "value": "deny" },
      "APIAppServiceHttpsEffect": { "value": "Deny" },
      "AppServiceHttpEffect": { "value": "Append" },
      "AppServiceTlsVersionEffect": { "value": "Append" },
      "AppServiceminTlsVersion": { "value": "1.2" },
      "ContainerAppsHttpsOnlyEffect": { "value": "Deny" },
      "FunctionAppTlsEffect": { "value": "DeployIfNotExists" },
      "LogicAppTlsEffect": { "value": "DeployIfNotExists" },
      "MySQLEnableSSLDeployEffect": { "value": "DeployIfNotExists" },
      "MySQLEnableSSLEffect": { "value": "Deny" },
      "MySQLminimalTlsVersion": { "value": "TLS1_2" },
      "PostgreSQLEnableSSLDeployEffect": { "value": "DeployIfNotExists" },
      "PostgreSQLEnableSSLEffect": { "value": "Deny" },
      "PostgreSQLminimalTlsVersion": { "value": "TLS1_2" },
      "RedisMinTlsVersion": { "value": "1.2" },
      "RedisTLSDeployEffect": { "value": "Append" },
      "RedisTLSEffect": { "value": "Deny" },
      "SQLManagedInstanceMinTlsVersion": { "value": "1.2" },
      "SQLManagedInstanceTLSDeployEffect": { "value": "DeployIfNotExists" },
      "SQLManagedInstanceTLSEffect": { "value": "Deny" },
      "SQLServerTLSDeployEffect": { "value": "DeployIfNotExists" },
      "SQLServerminTlsVersion": { "value": "1.2" },
      "StorageDeployHttpsEnabledEffect": { "value": "DeployIfNotExists" },
      "StorageMinimumTlsVersion": { "value": "TLS1_2" },
      "WebAppServiceHttpsEffect": { "value": "Deny" },
      "appServiceAppSlotTls": { "value": "DeployIfNotExists" },
      "appServiceAppSlotsHttps": { "value": "Deny" },
      "appServiceAppsHttps": { "value": "Deny" },
      "appServiceAppsTls": { "value": "DeployIfNotExists" },
      "appServiceTls": { "value": "Deny" },
      "eventHubMinTls": { "value": "Deny" },
      "functionAppHttps": { "value": "Deny" },
      "functionAppSlotsHttps": { "value": "Deny" },
      "functionAppSlotsTls": { "value": "DeployIfNotExists" },
      "logicAppHttpsEffect": { "value": "Deny" },
      "sqlDbTls": { "value": "Deny" },
      "storageAccountsTls": { "value": "Deny" },
      "synapseTlsVersion": { "value": "Deny" }
    },
    "metadata": {
      "assignedBy": "Policy Initiative Assigned by Platform Team as part of Q3 2025 policy rollout"
    },
    "scope": "/providers/Microsoft.Management/managementGroups/build-mg-landing-zones",
    "notScopes": []
  }
}
